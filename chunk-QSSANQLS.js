import{c as z}from"./chunk-IRLIELDQ.js";import{$a as g,Aa as a,Ab as L,Ba as M,Ja as k,K as D,Ka as A,M as T,Ma as p,Sa as c,Ta as w,V as y,Va as l,W as C,Wa as u,Xa as R,Ya as G,Za as j,_a as V,a as P,ab as h,b as N,bb as E,cb as F,db as x,eb as m,fb as S,gb as B,yb as U,zb as H}from"./chunk-7ANWDPTH.js";var K={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Ue=N(P({},K),{"[class.ng-submitted]":"isSubmitted"});var J=new T("",{providedIn:"root",factory:()=>$}),$="always";var ee=(()=>{class r{static \u0275fac=function(n){return new(n||r)};static \u0275mod=A({type:r});static \u0275inj=D({})}return r})();var W=(()=>{class r{static withConfig(e){return{ngModule:r,providers:[{provide:J,useValue:e.callSetDisabledState??$}]}}static \u0275fac=function(n){return new(n||r)};static \u0275mod=A({type:r});static \u0275inj=D({imports:[ee]})}return r})();var te=["canvas"],ne=["audioFile"];function ie(r,t){if(r&1){let e=V();l(0,"button",8),g("click",function(){y(e);let i=h();return C(i.audioFileRef.nativeElement.click())}),m(1,"Upload music"),u()}}function re(r,t){if(r&1&&(l(0,"span"),m(1),u()),r&2){let e=t.$implicit,n=t.index,i=h(3);w("--i",n)("--text-length",i.selectedFileName.length),a(),S(" ",e," ")}}function oe(r,t){if(r&1&&(G(0),p(1,re,2,5,"span",17),j()),r&2){let e=h(2);a(),c("ngForOf",e.selectedFileName.split(""))}}function se(r,t){if(r&1){let e=V();l(0,"div",9)(1,"div",10)(2,"div",11)(3,"div",12),p(4,oe,2,1,"ng-container",13),u()(),l(5,"div",14)(6,"button",15),g("click",function(){y(e);let i=h();return C(i.togglePlayPause())}),m(7),u()(),l(8,"div",16),m(9),u()()()}if(r&2){let e=h();a(),w("--progress",e.currentTime/e.duration*360+"deg"),a(3),c("ngIf",e.selectedFileName),a(2),c("disabled",!(e.audioFileRef.nativeElement.files!=null&&e.audioFileRef.nativeElement.files.length)),a(),S(" ",e.isPlaying?"\u275A\u275A":"\u25BA"," "),a(2),B(" ",e.formatTime(e.currentTime)," / ",e.formatTime(e.duration)," ")}}var q=class r{constructor(t){this.sanitizer=t;let e=`https://open.spotify.com/embed/playlist/${this.playlistId}?utm_source=generator&theme=1&autoplay=1`;this.playlistUrl=this.sanitizer.bypassSecurityTrustResourceUrl(e)}canvasRef;audioFileRef;ctx;audioContext;analyser;dataArray;bufferLength;audio;audioSource;isPlaying=!1;audioLoaded=!1;selectedFileName="";choseFile=!0;currentTime=0;duration=0;particlesArray=[];numberOfParticles=100;colorPalette=["#FF6B6B","#4ECDC4","#C7F464","#FFE66D","#FF9F1C"];playlistId="5W9YOseBdX1xOoLA8tppEh";circumference=2*Math.PI*90;playlistUrl;isMobile=!1;checkIfMobile(){this.isMobile=window.innerWidth<=600}onFileChange(t){let e=this.audioFileRef.nativeElement;if(e.files&&e.files.length>0){let n=e.files[0];this.selectedFileName=n.name;let i=URL.createObjectURL(n);this.audio&&(this.audio.pause(),this.audio.currentTime=0,this.audio.src=""),this.audio=new Audio(i),this.audio.addEventListener("timeupdate",()=>this.updateProgress()),this.audio.addEventListener("loadedmetadata",()=>{this.duration=this.audio.duration}),this.audio.addEventListener("ended",()=>{this.isPlaying=!1,this.audioLoaded=!0,this.choseFile=!0,this.currentTime=0}),this.setupAudioContext(),this.audioLoaded=!0,this.choseFile=!0}}togglePlayPause(){this.audio&&(this.isPlaying?(this.choseFile=!0,this.audio.pause()):(this.choseFile=!1,this.audio.play(),this.animate()),this.isPlaying=!this.isPlaying)}updateProgress(){this.currentTime=this.audio.currentTime}seekAudio(t){let e=t.target;this.audio.currentTime=parseFloat(e.value)}formatTime(t){let e=Math.floor(t/60),n=Math.floor(t%60);return`${e}:${n<10?"0":""}${n}`}ngAfterViewInit(){this.setupCanvas(),this.initParticles(),this.checkIfMobile(),window.addEventListener("resize",this.checkIfMobile.bind(this)),this.isMobile&&(this.numberOfParticles=200),this.animate()}setupCanvas(){let t=this.canvasRef.nativeElement;this.ctx=t.getContext("2d"),this.resizeCanvas(),window.addEventListener("resize",this.resizeCanvas.bind(this))}resizeCanvas(){let t=this.canvasRef.nativeElement;t.width=window.innerWidth,t.height=window.innerHeight}setupAudioContext(){this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=256,this.bufferLength=this.analyser.frequencyBinCount,this.dataArray=new Uint8Array(this.bufferLength),this.audioSource=this.audioContext.createMediaElementSource(this.audio),this.audioSource.connect(this.analyser),this.analyser.connect(this.audioContext.destination)}animate(){if(requestAnimationFrame(()=>this.animate()),!this.analyser)return;this.analyser.getByteFrequencyData(this.dataArray);let t=this.canvasRef.nativeElement,e=this.ctx,n=t.width,i=t.height;e.clearRect(0,0,n,i),this.isMobile||this.drawAudioVisualizer(),this.updateParticles(this.dataArray)}drawAudioVisualizer(){let t=this.canvasRef.nativeElement,e=this.ctx,n=t.width,i=t.height,_=this.bufferLength/2,o=n/_,Y=i/256,O=500;for(let s=0;s<_;s++){let f=this.dataArray[s]*Y;this.dataArray[s]<O&&(f=this.dataArray[s]/O*i);let b=Math.random()*360,X=(b+120)%360,Q=(b+240)%360,v=e.createLinearGradient(0,0,0,i);v.addColorStop(0,`hsl(${b}, 100%, 50%)`),v.addColorStop(.5,`hsl(${X}, 100%, 50%)`),v.addColorStop(1,`hsl(${Q}, 100%, 50%)`),e.fillStyle=v;let d=_-1-s;e.beginPath(),e.moveTo(d*o,0),e.lineTo(d*o+o,0),e.lineTo(d*o+o/2,f),e.closePath(),e.fill(),e.beginPath(),e.moveTo(s*o,i),e.lineTo(s*o+o,i),e.lineTo(s*o+o/2,i-f),e.closePath(),e.fill(),e.beginPath(),e.moveTo(0,s*o),e.lineTo(0,s*o+o),e.lineTo(f,s*o+o/2),e.closePath(),e.fill(),e.beginPath(),e.moveTo(n,d*o),e.lineTo(n,d*o+o),e.lineTo(n-f,d*o+o/2),e.closePath(),e.fill()}}updateParticles(t){let e=this.canvasRef.nativeElement,n=this.ctx;this.particlesArray.forEach(i=>{i.update(t),i.draw(n)})}initParticles(){let t=this.canvasRef.nativeElement;for(let e=0;e<this.numberOfParticles;e++)this.particlesArray.push(new I(t))}ngOnDestroy(){if(this.audio){let n=this.audio.volume/20,i=setInterval(()=>{this.audio.volume-n>0?this.audio.volume-=n:(clearInterval(i),this.audio.pause(),this.audio.src="",this.audioContext&&this.audioContext.close())},50)}window.removeEventListener("resize",this.resizeCanvas.bind(this)),window.removeEventListener("resize",this.checkIfMobile.bind(this))}static \u0275fac=function(e){return new(e||r)(M(z))};static \u0275cmp=k({type:r,selectors:[["app-visualizer"]],viewQuery:function(e,n){if(e&1&&(E(te,7),E(ne,7)),e&2){let i;F(i=x())&&(n.canvasRef=i.first),F(i=x())&&(n.audioFileRef=i.first)}},decls:9,vars:2,consts:[["canvas",""],["audioFile",""],["id","particlesCanvas"],[1,"upload-container"],[3,"click",4,"ngIf"],["type","file","accept","audio/*","hidden","",3,"change"],["id","audioControl"],["class","circular-wrapper",4,"ngIf"],[3,"click"],[1,"circular-wrapper"],[1,"circular-progress"],[1,"circular-text"],[1,"rotating-text"],[4,"ngIf"],[1,"play-button"],[3,"click","disabled"],[1,"time-display"],[3,"--i","--text-length",4,"ngFor","ngForOf"]],template:function(e,n){if(e&1){let i=V();R(0,"canvas",2)(1,"canvas",null,0),l(3,"div",3),p(4,ie,2,0,"button",4),l(5,"input",5,1),g("change",function(o){return y(i),C(n.onFileChange(o))}),u()(),l(7,"div",6),p(8,se,10,7,"div",7),u()}e&2&&(a(4),c("ngIf",n.choseFile),a(4),c("ngIf",n.audioLoaded))},dependencies:[L,U,H,W],styles:["canvas[_ngcontent-%COMP%]{display:block;width:100vw;height:100vh;max-width:100%;max-height:100%;position:fixed;top:0;left:0;pointer-events:none;z-index:-1}.upload-container[_ngcontent-%COMP%]{position:absolute;top:30%;left:50%;transform:translate(-50%,-50%);display:flex;flex-direction:column;align-items:center;z-index:2}.upload-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:#fff;color:#000;font-size:16px;padding:10px 24px;border:none;border-radius:20px;cursor:pointer;font-weight:700;transition:.3s}.upload-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#f0f0f0}#audioControl[_ngcontent-%COMP%]{position:absolute;top:55%;left:50%;transform:translate(-50%,-50%);color:#fff;text-align:center;width:480px;max-width:95vw;padding:20px;border-radius:12px;z-index:2}.circular-wrapper[_ngcontent-%COMP%]{position:relative;width:200px;height:200px;margin:0 auto 15px}.circular-progress[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:50%;background:conic-gradient(rgb(120,120,120) var(--progress),rgba(0,0,0,0) var(--progress));display:flex;align-items:center;justify-content:center;position:relative}.circular-text[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;animation:_ngcontent-%COMP%_rotateText 12s linear infinite}.rotating-text[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;transform:rotate(0)}.rotating-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;left:50%;top:0;transform-origin:0 100px;font-size:13px;color:#fff;white-space:nowrap;transform:rotate(calc(var(--i) * 360deg / var(--text-length))) translateY(-100px)}@keyframes _ngcontent-%COMP%_rotateText{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.time-display[_ngcontent-%COMP%]{color:#fff;font-size:12px;position:absolute;bottom:-30px;left:50%;transform:translate(-50%)}.play-button[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.play-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:56px;height:56px;border-radius:50%;border:none;background:#fff;font-size:28px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:.3s}.play-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#f0f0f0}@media (max-width: 768px){.upload-container[_ngcontent-%COMP%]{top:18%}#audioControl[_ngcontent-%COMP%]{width:95vw;padding:12px 2vw;font-size:14px;top:60%}.circular-wrapper[_ngcontent-%COMP%]{width:140px;height:140px}.rotating-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:10px;transform:rotate(calc(var(--i) * 360deg / var(--text-length))) translateY(-70px)}.play-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:42px;height:42px;font-size:20px}.time-display[_ngcontent-%COMP%]{font-size:11px;bottom:-24px}}@media (max-width: 480px){.upload-container[_ngcontent-%COMP%]{top:16%}#audioControl[_ngcontent-%COMP%]{width:98vw;padding:10px 2vw;font-size:13px;top:62%}.circular-wrapper[_ngcontent-%COMP%]{width:120px;height:120px}.rotating-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:9px;transform:rotate(calc(var(--i) * 360deg / var(--text-length))) translateY(-60px)}.play-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:38px;height:38px;font-size:18px}.time-display[_ngcontent-%COMP%]{font-size:10px}}@media (max-width: 360px){.upload-container[_ngcontent-%COMP%]{top:14%}#audioControl[_ngcontent-%COMP%]{font-size:12px;top:64%}.circular-wrapper[_ngcontent-%COMP%]{width:100px;height:100px}.rotating-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:8px;transform:rotate(calc(var(--i) * 360deg / var(--text-length))) translateY(-50px)}.play-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:34px;height:34px;font-size:16px}.time-display[_ngcontent-%COMP%]{font-size:9px}}"]})},I=class{constructor(t){this.canvas=t;this.x=Math.random()*t.width,this.y=Math.random()*t.height,this.baseSize=Math.random()*5+2,this.size=this.baseSize,this.speedX=Math.random()*2-1,this.speedY=Math.random()*2-1,this.color=["#FF6B6B","#4ECDC4","#C7F464","#FFE66D","#FF9F1C"][Math.floor(Math.random()*5)]}x;y;size;speedX;speedY;color;baseSize;update(t){let e=t[0],n=t[t.length-1];this.x+=this.speedX+Math.sin(this.y*.01)*(e/128),this.y+=this.speedY+Math.cos(this.x*.01)*(n/128),(this.x>this.canvas.width||this.x<0)&&(this.speedX*=-1),(this.y>this.canvas.height||this.y<0)&&(this.speedY*=-1),this.size=this.baseSize+e/256*10}draw(t){t.beginPath(),t.arc(this.x,this.y,this.size,0,Math.PI*2),t.fillStyle=this.color,t.fill()}};export{q as VisualizerComponent};
