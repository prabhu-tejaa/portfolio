import{c as $}from"./chunk-IRLIELDQ.js";import{$a as m,Aa as a,Ab as L,Ba as M,Ja as R,K as D,Ka as w,M as T,Ma as g,Sa as h,Ta as A,V as y,Va as l,W as C,Wa as d,Xa as G,Ya as j,Za as B,_a as b,a as N,ab as f,b as k,bb as E,cb as F,db as x,eb as _,fb as S,gb as U,yb as z,zb as H}from"./chunk-7ANWDPTH.js";var J={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},ze=k(N({},J),{"[class.ng-submitted]":"isSubmitted"});var ee=new T("",{providedIn:"root",factory:()=>W}),W="always";var te=(()=>{class r{static \u0275fac=function(i){return new(i||r)};static \u0275mod=w({type:r});static \u0275inj=D({})}return r})();var q=(()=>{class r{static withConfig(e){return{ngModule:r,providers:[{provide:ee,useValue:e.callSetDisabledState??W}]}}static \u0275fac=function(i){return new(i||r)};static \u0275mod=w({type:r});static \u0275inj=D({imports:[te]})}return r})();var ie=["canvas"],ne=["audioFile"];function re(r,t){if(r&1){let e=b();l(0,"button",7),m("click",function(){y(e);let n=f();return C(n.audioFileRef.nativeElement.click())}),_(1,"Upload music"),d()}}function se(r,t){if(r&1&&(l(0,"span"),_(1),d()),r&2){let e=t.$implicit,i=t.index,n=f(3);A("--i",i)("--text-length",n.selectedFileName.length),a(),S(" ",e," ")}}function oe(r,t){if(r&1&&(j(0),g(1,se,2,5,"span",16),B()),r&2){let e=f(2);a(),h("ngForOf",e.selectedFileName.split(""))}}function ae(r,t){if(r&1){let e=b();l(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11),g(4,oe,2,1,"ng-container",12),d()(),l(5,"div",13)(6,"button",14),m("click",function(){y(e);let n=f();return C(n.togglePlayPause())}),_(7),d()(),l(8,"div",15),_(9),d()()()}if(r&2){let e=f();a(),A("--progress",e.currentTime/e.duration*360+"deg"),a(3),h("ngIf",e.selectedFileName),a(2),h("disabled",!(e.audioFileRef.nativeElement.files!=null&&e.audioFileRef.nativeElement.files.length)),a(),S(" ",e.isPlaying?"\u275A\u275A":"\u25BA"," "),a(2),U(" ",e.formatTime(e.currentTime)," / ",e.formatTime(e.duration)," ")}}var Y=class r{constructor(t){this.sanitizer=t;let e=`https://open.spotify.com/embed/playlist/${this.playlistId}?utm_source=generator&theme=1&autoplay=1`;this.playlistUrl=this.sanitizer.bypassSecurityTrustResourceUrl(e)}canvasRef;audioFileRef;ctx;audioContext;analyser;dataArray;bufferLength;audio;audioSource;isPlaying=!1;audioLoaded=!1;selectedFileName="";choseFile=!0;currentTime=0;duration=0;particlesArray=[];numberOfParticles=100;colorPalette=["#FF6B6B","#4ECDC4","#C7F464","#FFE66D","#FF9F1C"];playlistId="5W9YOseBdX1xOoLA8tppEh";circumference=2*Math.PI*90;playlistUrl;isMobile=!1;twinkleStars=[];twinkleCount=7;checkIfMobile(){this.isMobile=window.innerWidth<=600}onFileChange(t){let e=this.audioFileRef.nativeElement;if(e.files&&e.files.length>0){let i=e.files[0];this.selectedFileName=i.name;let n=URL.createObjectURL(i);this.audio&&(this.audio.pause(),this.audio.currentTime=0,this.audio.src=""),this.audio=new Audio(n),this.audio.addEventListener("timeupdate",()=>this.updateProgress()),this.audio.addEventListener("loadedmetadata",()=>{this.duration=this.audio.duration}),this.audio.addEventListener("ended",()=>{this.isPlaying=!1,this.audioLoaded=!0,this.choseFile=!0,this.currentTime=0}),this.setupAudioContext(),this.audioLoaded=!0,this.choseFile=!0}}togglePlayPause(){this.audio&&(this.isPlaying?(this.choseFile=!0,this.audio.pause()):(this.choseFile=!1,this.audio.play(),this.animate()),this.isPlaying=!this.isPlaying)}updateProgress(){this.currentTime=this.audio.currentTime}seekAudio(t){let e=t.target;this.audio.currentTime=parseFloat(e.value)}formatTime(t){let e=Math.floor(t/60),i=Math.floor(t%60);return`${e}:${i<10?"0":""}${i}`}ngAfterViewInit(){this.setupCanvas(),this.checkIfMobile(),this.numberOfParticles=this.isMobile?37:100,this.initParticles(),this.initTwinkleStars(),window.addEventListener("resize",this.checkIfMobile.bind(this)),window.addEventListener("resize",this.handleResizeTwinkleStars.bind(this)),this.animate()}setupCanvas(){let t=this.canvasRef.nativeElement;this.ctx=t.getContext("2d"),this.resizeCanvas(),window.addEventListener("resize",this.resizeCanvas.bind(this))}resizeCanvas(){let t=this.canvasRef.nativeElement;t.width=window.innerWidth,t.height=window.innerHeight}setupAudioContext(){this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=256,this.bufferLength=this.analyser.frequencyBinCount,this.dataArray=new Uint8Array(this.bufferLength),this.audioSource=this.audioContext.createMediaElementSource(this.audio),this.audioSource.connect(this.analyser),this.analyser.connect(this.audioContext.destination)}animate(){if(requestAnimationFrame(()=>this.animate()),!this.analyser)return;this.analyser.getByteFrequencyData(this.dataArray);let t=this.canvasRef.nativeElement,e=this.ctx,i=t.width,n=t.height;e.clearRect(0,0,i,n),this.isMobile||this.drawAudioVisualizer(),this.updateParticles(this.dataArray),this.updateTwinkleStars()}drawAudioVisualizer(){let t=this.canvasRef.nativeElement,e=this.ctx,i=t.width,n=t.height,u=this.bufferLength/2,s=i/u,X=n/256,P=500;for(let o=0;o<u;o++){let p=this.dataArray[o]*X;this.dataArray[o]<P&&(p=this.dataArray[o]/P*n);let V=Math.random()*360,Q=(V+120)%360,Z=(V+240)%360,v=e.createLinearGradient(0,0,0,n);v.addColorStop(0,`hsl(${V}, 100%, 50%)`),v.addColorStop(.5,`hsl(${Q}, 100%, 50%)`),v.addColorStop(1,`hsl(${Z}, 100%, 50%)`),e.fillStyle=v;let c=u-1-o;e.beginPath(),e.moveTo(c*s,0),e.lineTo(c*s+s,0),e.lineTo(c*s+s/2,p),e.closePath(),e.fill(),e.beginPath(),e.moveTo(o*s,n),e.lineTo(o*s+s,n),e.lineTo(o*s+s/2,n-p),e.closePath(),e.fill(),e.beginPath(),e.moveTo(0,o*s),e.lineTo(0,o*s+s),e.lineTo(p,o*s+s/2),e.closePath(),e.fill(),e.beginPath(),e.moveTo(i,c*s),e.lineTo(i,c*s+s),e.lineTo(i-p,c*s+s/2),e.closePath(),e.fill()}}updateParticles(t){let e=this.canvasRef.nativeElement,i=this.ctx;this.particlesArray.forEach(n=>{n.update(t,this.isPlaying),n.draw(i)})}initParticles(){let t=this.canvasRef.nativeElement;this.particlesArray=[];for(let e=0;e<this.numberOfParticles;e++)this.particlesArray.push(new I(t))}initTwinkleStars(){let t=this.canvasRef.nativeElement;this.twinkleStars=[];for(let e=0;e<this.twinkleCount;e++)this.twinkleStars.push(new O(t))}updateTwinkleStars(){let t=this.ctx;this.twinkleStars.forEach(e=>{e.update(),e.draw(t)})}handleResizeTwinkleStars(){this.initTwinkleStars()}ngOnDestroy(){if(this.audio){let i=this.audio.volume/20,n=setInterval(()=>{this.audio.volume-i>0?this.audio.volume-=i:(clearInterval(n),this.audio.pause(),this.audio.src="",this.audioContext&&this.audioContext.close())},50)}window.removeEventListener("resize",this.resizeCanvas.bind(this)),window.removeEventListener("resize",this.checkIfMobile.bind(this)),window.removeEventListener("resize",this.handleResizeTwinkleStars.bind(this))}static \u0275fac=function(e){return new(e||r)(M($))};static \u0275cmp=R({type:r,selectors:[["app-visualizer"]],viewQuery:function(e,i){if(e&1&&(E(ie,7),E(ne,7)),e&2){let n;F(n=x())&&(i.canvasRef=n.first),F(n=x())&&(i.audioFileRef=n.first)}},decls:8,vars:2,consts:[["canvas",""],["audioFile",""],[1,"upload-container"],[3,"click",4,"ngIf"],["type","file","accept","audio/*","hidden","",3,"change"],["id","audioControl"],["class","circular-wrapper",4,"ngIf"],[3,"click"],[1,"circular-wrapper"],[1,"circular-progress"],[1,"circular-text"],[1,"rotating-text"],[4,"ngIf"],[1,"play-button"],[3,"click","disabled"],[1,"time-display"],[3,"--i","--text-length",4,"ngFor","ngForOf"]],template:function(e,i){if(e&1){let n=b();G(0,"canvas",null,0),l(2,"div",2),g(3,re,2,0,"button",3),l(4,"input",4,1),m("change",function(s){return y(n),C(i.onFileChange(s))}),d()(),l(6,"div",5),g(7,ae,10,7,"div",6),d()}e&2&&(a(3),h("ngIf",i.choseFile),a(4),h("ngIf",i.audioLoaded))},dependencies:[L,z,H,q],styles:["canvas[_ngcontent-%COMP%]{display:block;width:100vw;height:100vh;max-width:100%;max-height:100%;position:fixed;top:0;left:0;pointer-events:none;z-index:-1}.upload-container[_ngcontent-%COMP%]{position:absolute;top:30%;left:50%;transform:translate(-50%,-50%);display:flex;flex-direction:column;align-items:center;z-index:2}.upload-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:#fff;color:#000;font-size:16px;padding:10px 24px;border:none;border-radius:20px;cursor:pointer;font-weight:700;transition:.3s}.upload-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#f0f0f0}#audioControl[_ngcontent-%COMP%]{position:absolute;top:55%;left:50%;transform:translate(-50%,-50%);color:#fff;text-align:center;width:480px;max-width:95vw;padding:20px;border-radius:12px;z-index:2}.circular-wrapper[_ngcontent-%COMP%]{position:relative;width:200px;height:200px;margin:0 auto 15px}.circular-progress[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:50%;background:conic-gradient(rgb(120,120,120) var(--progress),rgba(0,0,0,0) var(--progress));display:flex;align-items:center;justify-content:center;position:relative}.circular-text[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;animation:_ngcontent-%COMP%_rotateText 12s linear infinite}.rotating-text[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;transform:rotate(0)}.rotating-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;left:50%;top:0;transform-origin:0 100px;font-size:13px;color:#fff;white-space:nowrap;transform:rotate(calc(var(--i) * 360deg / var(--text-length))) translateY(-100px)}@keyframes _ngcontent-%COMP%_rotateText{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.time-display[_ngcontent-%COMP%]{color:#fff;font-size:12px;position:absolute;bottom:-30px;left:50%;transform:translate(-50%)}.play-button[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.play-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:56px;height:56px;border-radius:50%;border:none;background:#fff;font-size:28px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:.3s}.play-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#f0f0f0}@media (max-width: 768px){.upload-container[_ngcontent-%COMP%]{top:18%}#audioControl[_ngcontent-%COMP%]{width:95vw;padding:12px 2vw;font-size:14px;top:60%}.circular-wrapper[_ngcontent-%COMP%]{width:140px;height:140px}.rotating-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:10px;transform:rotate(calc(var(--i) * 360deg / var(--text-length))) translateY(-70px)}.play-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:42px;height:42px;font-size:20px}.time-display[_ngcontent-%COMP%]{font-size:11px;bottom:-24px}}@media (max-width: 480px){.upload-container[_ngcontent-%COMP%]{top:16%}#audioControl[_ngcontent-%COMP%]{width:98vw;padding:10px 2vw;font-size:13px;top:62%}.circular-wrapper[_ngcontent-%COMP%]{width:120px;height:120px}.rotating-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:9px;transform:rotate(calc(var(--i) * 360deg / var(--text-length))) translateY(-60px)}.play-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:38px;height:38px;font-size:18px}.time-display[_ngcontent-%COMP%]{font-size:10px}}@media (max-width: 360px){.upload-container[_ngcontent-%COMP%]{top:14%}#audioControl[_ngcontent-%COMP%]{font-size:12px;top:64%}.circular-wrapper[_ngcontent-%COMP%]{width:100px;height:100px}.rotating-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:8px;transform:rotate(calc(var(--i) * 360deg / var(--text-length))) translateY(-50px)}.play-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:34px;height:34px;font-size:16px}.time-display[_ngcontent-%COMP%]{font-size:9px}}"]})},I=class{constructor(t){this.canvas=t;this.x=Math.random()*t.width,this.y=Math.random()*t.height,this.baseSize=Math.random()*5+2,this.size=this.baseSize,this.speedX=Math.random()*2-1,this.speedY=Math.random()*2-1,this.color=["#4ECDC4","#C7F464","#FFE66D","#FF9F1C","#FF6B6B","#1A535C","#6A4C93","#FFB5E8","#B8F2E6","#D0E6A5","#FFDAC1","#F4A261","#2A9D8F","#E76F51","#9D4EDD","#00B4D8","#F72585","#3A86FF","#8338EC","#FFD6A5","#06D6A0"][Math.floor(Math.random()*20)]}x;y;size;speedX;speedY;color;baseSize;update(t,e){let i=t[0],n=t[t.length-1],u=Date.now()*.001,s=t[Math.floor(t.length/2)];this.x+=this.speedX+Math.sin(this.y*.01+u*.5)*(i/128)+(Math.random()-.5)*(s/64),this.y+=this.speedY+Math.cos(this.x*.008-u*.3)*(n/96)+Math.sin(u*.7)*(s/128),e?(this.x>this.canvas.width&&(this.x=0),this.x<0&&(this.x=this.canvas.width),this.y>this.canvas.height&&(this.y=0),this.y<0&&(this.y=this.canvas.height)):((this.x>this.canvas.width||this.x<0)&&(this.speedX*=-1),(this.y>this.canvas.height||this.y<0)&&(this.speedY*=-1)),this.size=this.baseSize+i/256*8-n/512*6,this.size=Math.max(this.baseSize*.5,this.size)}draw(t){t.beginPath(),t.arc(this.x,this.y,this.size,0,Math.PI*2),t.fillStyle=this.color,t.fill()}},O=class{x;y;baseX;baseY;radius;radiusBase;radiusPulse;alpha;speed;direction;floatAngle;floatRadius;color;canvas;constructor(t){this.canvas=t,this.baseX=Math.random()*t.width,this.baseY=Math.random()*t.height,this.x=this.baseX,this.y=this.baseY,this.radiusBase=1+Math.random()*1.2,this.radiusPulse=.05+Math.random()*.05,this.radius=this.radiusBase,this.alpha=Math.random(),this.speed=.002+Math.random()*.003,this.direction=Math.random()>.5?1:-1,this.floatAngle=Math.random()*Math.PI*2,this.floatRadius=.3+Math.random()*.5;let e=["#fffbe6","#ffeedd","#e6f7ff"];this.color=e[Math.floor(Math.random()*e.length)]}update(){this.alpha+=this.speed*this.direction,this.alpha<=.1&&(this.alpha=.1,this.direction=1),this.alpha>=1&&(this.alpha=1,this.direction=-1),this.floatAngle+=.01,this.x=this.baseX+Math.cos(this.floatAngle)*this.floatRadius,this.y=this.baseY+Math.sin(this.floatAngle)*this.floatRadius,this.radius=this.radiusBase+Math.sin(Date.now()*.005*this.speed)*this.radiusPulse}draw(t){t.save(),t.globalAlpha=this.alpha,t.shadowBlur=3+this.alpha*6,t.shadowColor=this.color,t.beginPath(),t.arc(this.x,this.y,this.radius,0,2*Math.PI),t.fillStyle=this.color,t.fill(),t.restore()}};export{Y as VisualizerComponent};
