<section class="about-container" #container [class.modal-open]="isModalOpen">

  <div class="timeline">
    <div class="center-line"></div>

    <div class="event-row" *ngFor="let item of timeline; let i = index" [class.left]="i % 2 === 0"
      [class.right]="i % 2 !== 0">
      <div class="dot-column">
        <div class="dot">
          <span>{{ item.icon }}</span>
        </div>
      </div>

      <div class="content-card" (click)="openModal(item)">
        <span class="year">{{ item.year }}</span>
        <h3>{{ item.title }}</h3>
        <div class="description-wrapper">
          <p class="truncate-text">{{ item.desc }}</p>
          <span class="discovery-hint">
            <span class="hint-symbol">→</span>
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Perspective Modal Overlay -->
  <div class="modal-overlay" *ngIf="isModalOpen" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <button class="close-btn" (click)="closeModal()">&times;</button>

      <div class="modal-header">
        <!-- Back Button for Nested View -->
        <button class="back-btn" *ngIf="selectedSubItem" (click)="closeSubItem()">
          ← Back
        </button>

        <div class="header-icon-container">
          <span class="modal-icon">{{ selectedSubItem ? selectedSubItem.icon : selectedItem?.icon }}</span>
        </div>
        <div class="header-text">
          <span class="modal-year" *ngIf="!selectedSubItem">{{ selectedItem?.year }}</span>
          <span class="modal-category" *ngIf="selectedSubItem">{{ selectedItem?.title }}</span>
          <h2>{{ selectedSubItem ? selectedSubItem.title : selectedItem?.title }}</h2>
        </div>
      </div>

      <div class="modal-body" data-lenis-prevent>
        <!-- 1. Standard View (No Sub-items) -->
        <p class="main-text" *ngIf="!selectedItem?.subItems">{{ selectedItem?.fullDesc }}</p>

        <!-- 2. Menu View (Sub-items List) -->
        <div class="sub-item-grid" *ngIf="selectedItem?.subItems && !selectedSubItem">
          <div class="glass-card" *ngFor="let sub of selectedItem.subItems" (click)="openSubItem(sub)">
            <div class="card-icon">{{ sub.icon }}</div>
            <div class="card-content">
              <h3>{{ sub.title }}</h3>
              <p>{{ sub.desc }}</p>
            </div>
            <div class="enter-symbol">→</div>
          </div>
        </div>

        <!-- 3. Detail View (Selected Sub-item) -->
        <div class="detail-view" *ngIf="selectedSubItem">
          <p class="main-text">{{ selectedSubItem.fullDesc }}</p>
        </div>
      </div>

      <div class="modal-footer">
        <div class="galactic-line"></div>
        <!-- <span class="footer-note">End of transmission</span> -->
      </div>
    </div>
  </div>

</section>